# Overrides used for production branch.

exposeDomains:
  prod-traefik:
    hostname: drupal-project-k8s.wdr.io
  # prod-gke:
  #   hostname: gke-ingress-test.silta.wdr.io
  #   ingress: gce

# ingress:
#   gce:
#     staticIpAddressName: gke-ingress-test

# nginx:
#   serverExtraConfig: |
#     # Traefik IP for pre-generated hostname
#     set_real_ip_from 10.0.0.0/8;
#     # Load Balancer IP for gke-ingress-test.wdr.io
#     set_real_ip_from 34.102.231.235/32;
#     # Google load balancer IP's
#     set_real_ip_from 130.211.0.0/22;
#     set_real_ip_from 35.191.0.0/16;
#     real_ip_recursive on;


# Provide a high-availability, autoscaling deployment.
replicas: 2
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 5

# Enable daily backups.
backup:
  enabled: true

php:
  cron:
    drupal:
      # In production environments, run cron every 5 minutes. Adjust as needed.
      schedule: '*/5 * * * *'
  # Reserve more resources for our PHP containers.
  resources:
    requests:
      cpu: 200m
      memory: 256M
    limits:
      cpu: 500m
      memory: 512M

  # Don't show errors in production.
  errorLevel: "hide"

nginx:
# Uncomment these lines to disable basic auth protection.
#  basicauth:
#    enabled: false
  resources:
    requests:
      cpu: 50m
      memory: 50M
    limits:
      cpu: 100m
      memory: 150M
  noauthips:
    # Let Fastly bypass Silta basic auth.
    # For staging env basic auth is configured in Fastly instead.
    # Source: https://api.fastly.com/public-ip-list
    fastly0: 23.235.32.0/20
    fastly1: 43.249.72.0/22
    fastly2: 103.244.50.0/24
    fastly3: 103.245.222.0/23
    fastly4: 103.245.224.0/24
    fastly5: 104.156.80.0/20
    fastly6: 140.248.64.0/18
    fastly7: 140.248.128.0/17
    fastly8: 146.75.0.0/17
    fastly9: 151.101.0.0/16
    fastly10: 157.52.64.0/18
    fastly11: 167.82.0.0/17
    fastly12: 167.82.128.0/20
    fastly13: 167.82.160.0/20
    fastly14: 167.82.224.0/20
    fastly15: 172.111.64.0/18
    fastly16: 185.31.16.0/22
    fastly17: 199.27.72.0/21
    fastly18: 199.232.0.0/16

mariadb:
  master:
    resources:
      requests:
        cpu: 250m
        memory: 500M
      limits:
        cpu: 1000m
        memory: 750M

# Consider enabling memcached service
# memcached:
#   enabled: true

# Connect to an externally hosted database.
#  env:
#    DB_HOST: 'hosted.database.server.com'
#    DB_NAME: 'drupal-1A4G3C'
#    DB_USER: 'drupal'
#    DB_PASS: 'never store passwords'
# Disable the built-in database when using an external database.
#mariadb:
#  enabled: false

# Fastly WAF.
signalsciences:
  enabled: true

mailpit:
  enabled: false
