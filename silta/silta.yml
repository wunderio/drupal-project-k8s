
# Values in this file override the default values of our helm chart.
#
# See https://github.com/wunderio/charts/blob/master/drupal/values.yaml
# for all possible options.

varnish:
  enabled: false

elasticsearch:
  enabled: false

memcached:
  enabled: false

redis:
  enabled: false
  auth:
    password: "foo"

mounts:
  private-files:
    enabled: true

# Allow access from another namespace for testing purposes.
silta-release:
  # proxy:
  #   enabled: true
  #   no_proxy: ".example.com"
  ingressAccess:
    test:
      additionalPodSelector:
        app: drupal
      from:
        - namespaceSelector:
            matchLabels:
              name: drupal-project
    allowESaccess:
      additionalPodSelector:
        chart: elasticsearch
      from:
        - namespaceSelector:
            matchLabels:
              name: drupal-project

nginx:
  extraConfig: |
    # Show server host name as header
    add_header X-Backend-Server $hostname;

php:
  cron:
    drupal:
      # Disable cron jobs in feature environments by using non-existing date.
      # The ~ symbol will be replaced by a random digit from 0 to 9.
      # This will avoid running all cron jobs at the same time.
      schedule: '~ 0 31 2 *'

# mariadb-galera:
mariadb-galera:
  enabled: true

  # FOR FUTURE REFERENCE: Test recovery before merging. 
  # Sequence to break cluster:
  # - Kill 2nd replica (-1), then first (-0) and before first two are ready, 
  # kill third (-2). Cluster should recover (but it does not).

#   galera:
#     bootstrap:
#       bootstrapFromNode: 0
#       forceSafeToBootstrap: true

  # initdbScripts:
  #   my_init_script.sh: |
  #     #!/bin/sh
  #     if [[ $(hostname) == *-0  ]]; then
  #       echo "First node"
  #       mysql -P 3306 -uroot -prandompassword -e "create database new_database";
  #     else
  #       echo "No first node"
  #     fi

mariadb:
  enabled: false

db:
  primary: mariadb-galera

